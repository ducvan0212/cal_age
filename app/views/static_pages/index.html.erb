<div class="cover center">
  <form role="form">
    <div class="form-group row">
      <div class="col-md-5"><label for="dob" class="col-md-2">DOB</label></div>
      <div class="col-md-7"><input type="text" class="col-md-3 form-control" id="dob" name="dob" placeholder="dd.mm.yyyy"></div>
    </div>

    <div class="form-group row">
      <div class="col-md-5"><label for="cal_date">Ngày phát hành hợp đồng</label></div>
      <div class="col-md-7"><input type="text" name="cal_date" placeholder="dd.mm.yyyy" class="form-control"></div>
    </div>

    <div class="form-group row">
      <button type="submit" class="btn btn-primary col-md-12">Tính</button>
    </div>
  </form>
  <p id="age-result" class="age-group text-center">Số tuổi: <span id="r"></span></p>

  <p class="age-group">Các sản phẩm không thoả mãn:</p>
  <table class="table">
    <tr class="age-group" id="5to7">
      <th>R5-R7</th>
      <td>tuoi < 69</td>
    </tr>
    <tr class="age-group" id="6">
      <th>R6</th>
      <td>tuoi < 69</td>
    </tr>
    <tr class="age-group" id="8">
      <th>R8</th>
      <td>16 < tuoi < 60</td>
    </tr>
    <!-- <tr class="age-group" id="10to56to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="10to56">
          <th>R10-56</th>
          <td>tuoi < 56</td>
        </tr>
        <tr class="age-group" id="10to60">
          <th>R10-60</th>
          <td>57 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="11to50to55"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="11to50">
          <th>R11-50</th>
          <td>tuoi < 51</td>
        </tr>
        <tr class="age-group" id="11to55">
          <th>R11-55</th>
          <td>52 < tuoi < 55</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="12to55to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="12to55">
          <th>R12-55</th>
          <td>tuoi < 55</td>
        </tr>
        <tr class="age-group" id="12to60">
          <th>R12-60</th>
          <td>56 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="13to55to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="13to55">
          <th>R13-55</th>
          <td>tuoi < 55</td>
        </tr>
        <tr class="age-group" id="13to60">
          <th>R13-60</th>
          <td>56 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="14to46to56to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="14to46">
          <th>R14-46</th>
          <td>18 < tuoi < 46</td>
        </tr>
        <tr class="age-group" id="14to56">
          <th>R14-56</th>
          <td>18 < tuoi < 56</td>
        </tr>
        <tr class="age-group" id="14to60">
          <th>R14-60</th>
          <td>57 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="15to56to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="15to56">
          <th>R15-56</th>
          <td>18 < tuoi < 56</td>
        </tr>
        <tr class="age-group" id="15to60">
          <th>R15-60</th>
          <td>57 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="16to56to60"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="16to56">
          <th>R16-56</th>
          <td>tuoi < 56</td>
        </tr>
        <tr class="age-group" id="16to60">
          <th>R16-60</th>
          <td>57 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
    <!-- <tr class="age-group" id="17"> -->
      <!-- <table class="table"> -->
        <tr class="age-group" id="17tondbh">
          <th>R17-NĐBH</th>
          <td>tuoi < 60</td>
        </tr>
        <tr class="age-group" id="17tobmbh">
          <th>R17-BMBH</th>
          <td>18 < tuoi < 60</td>
        </tr>
      <!-- </table> -->
    <!-- </tr> -->
  </table>
</div>

<script type="text/javascript">
$(document).ready(function(){
  $('.age-group td').addClass('hide');
  $('.age-group').addClass('hide');

  $("button[type='submit']").click(function(event) {
    console.log("=======================");
    var pattern = /(\d{1,2})\.(\d{1,2})\.(\d{4})/;
    var calDate = new Date($("input[name='cal_date']").val().replace(pattern, '$3/$2/$1'));
    var dob = new Date($("input[name='dob']").val().replace(pattern, '$3/$2/$1'));
    
    var milestone = new Date($("input[name='dob']").val().replace(pattern, '$3/$2/$1'));
    milestone.setFullYear(calDate.getFullYear());
    if (calDate < milestone) {
      milestone.setFullYear(calDate.getFullYear() - 1);
    };
    console.log(milestone);

    var sixMonthsFromMilestone = new Date(milestone);
    sixMonthsFromMilestone.setMonth(sixMonthsFromMilestone.getMonth() + 6)
    console.log(sixMonthsFromMilestone);

    var oneYearFromMilestone = new Date(milestone);
    oneYearFromMilestone.setMonth(oneYearFromMilestone.getMonth() + 12)
    console.log(oneYearFromMilestone);

    var calFrom;
    if (calDate < sixMonthsFromMilestone) {
      calFrom = milestone;
    } else {
      calFrom = oneYearFromMilestone;
    };
    console.log(calFrom);

    age = calFrom.getFullYear() - dob.getFullYear();
    $('#r').html(age);
    $('.age-group').removeClass('success hide');
    if (age <= 69) { $('#5to7').addClass("success"); };
    if (age <= 69) { $('#6').addClass("success"); };
    if (age >= 16 && age <= 60) { $('#8').addClass("success"); };
    if (age <= 56) { $('#10to56').addClass("success"); };
    if (age <= 60 && age >= 57) {$('#10to60').addClass("success"); };
    if (age <= 51) { $('#11to50').addClass("success"); };
    if (age <= 55 && age >= 52) { $('#11to55').addClass("success"); };
    if (age <= 55) { $('#12to55').addClass("success"); };
    if (age <= 60 && age >= 56) {$('#12to60').addClass("success"); };
    if (age <= 55) { $('#13to55').addClass("success"); };
    if (age <= 60 && age >= 56) { $('#13to60').addClass("success"); };
    if (age <= 46 && age >= 18) { $('#14to46').addClass("success"); };
    if (age <= 56 && age >= 18) { $('#14to56').addClass("success"); };
    if (age <= 60 && age >= 57) { $('#14to60').addClass("success"); };
    if (age <= 56 && age >= 18) { $('#15to56').addClass("success"); };
    if (age <= 60 && age >= 57) { $('#15to60').addClass("success"); };
    if (age <= 56) { $('#16to56').addClass("success"); };
    if (age <= 60 && age >= 57) { $('#16to60').addClass("success"); };
    if (age <= 60) { $('#17tondbh').addClass("success"); };
    if (age <= 60 && age >= 18) { $('#17tobmbh').addClass("success"); };

    $('.success').addClass('hide');
    event.preventDefault ? event.preventDefault() : event.returnValue = false;
  });
});
</script>